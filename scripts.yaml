movie_time:
  alias: "Movie Time"
  icon: "mdi:movie"
  sequence:
    - condition: state
      entity_id: alarm_control_panel.alarm
      state: "disarmed"
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # put shades down
    - service: cover.close_cover
      entity_id: cover.window_shade_5
    - service: cover.close_cover
      entity_id: cover.window_shade_4
    # if the sun is down then close all shades and put the lights on
    - condition: template
      value_template: "{{ is_state('sun.sun', 'below_horizon') }}"
    - service: cover.close_cover
      entity_id: cover.window_shade_3
    - service: cover.close_cover
      entity_id: cover.window_shade_2
    - service: scene.turn_on
      entity_id: scene.mood_lights

mood_lights:
  alias: "Mood Lights"
  icon: "mdi:lamps"
  sequence:
    - service: scene.turn_on
      data:
        entity_id: scene.mood_lights

climate_away:
  sequence:
    - service: climate.turn_off
      entity_id:
        - climate.downstairs
        - climate.upstairs
        - climate.bathroom_floor

climate_windows_open:
  sequence:
    - service: climate.turn_off
      entity_id:
        - climate.downstairs
        - climate.upstairs
    - service: notify.phones
      data:
        title: "Beach"
        message: "Turning HVAC off since windows left open"

dinner_lights:
  alias: "Dinner Lights"
  icon: "mdi:food-fork-drink"
  sequence:
    - service: scene.turn_on
      data:
        entity_id: scene.dinner_lights

good_morning:
  alias: "Good Morning"
  icon: "mdi:brightness-5"
  sequence:
    # only run when the alarm is off to prevent accidental triggers
    - condition: state
      entity_id: alarm_control_panel.alarm
      state: "disarmed"
    - service: scene.turn_on
      entity_id: scene.good_morning
    - service: script.turn_on
      entity_id: script.upstairs_shades_up
    - service: script.turn_on
      entity_id: script.downstairs_shades_up

good_night:
  alias: "Good Night"
  icon: "mdi:brightness-2"
  sequence:
    - service: scene.turn_on
      entity_id: scene.lights_off
    - service: script.turn_on
      entity_id: script.downstairs_shades_down_all
    - service: script.turn_on
      entity_id: script.upstairs_shades_down

goodbye:
  alias: "Goodbye"
  sequence:
    - service: homeassistant.turn_off
      entity_id: light.house
    - service: script.turn_on
      entity_id: script.downstairs_shades_down_all
    - service: script.turn_on
      entity_id: script.upstairs_shades_down
    - service: script.climate_away

welcome_home:
  alias: "Welcome Home"
  sequence:
    - service: climate.set_hvac_mode
      entity_id: climate.bathroom_floor
      data:
        hvac_mode: heat
    - if:
        - condition: template
          value_template: "{{ state_attr('sun.sun', 'elevation') < -4 }}"
      then:
        - service: homeassistant.turn_on
          target:
            entity_id: script.welcome_lights
      else: 
        - service: homeassistant.turn_on
          target:
            entity_id: script.downstairs_shades_up
        - service: homeassistant.turn_on
          target:
            entity_id: script.upstairs_shades_up

welcome_lights:
  sequence:
    - service: homeassistant.turn_on
      entity_id:
        - light.kitchen_lights
        - light.front_yard

downstairs_shades_up:
  alias: "Downstairs Shades Up"
  icon: "mdi:grid-large"
  sequence:
    - condition: state
      entity_id: alarm_control_panel.alarm
      state: "disarmed"
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # raise each of the shades
    - service: cover.open_cover
      entity_id: cover.window_shade_5
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.window_shade_4
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.window_shade_3
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.window_shade_2
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.window_shade_1
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.window_shade_6

downstairs_shades_down:
  alias: "Downstairs Shades Down"
  icon: "mdi:grid-large"
  sequence:
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # lower the front shades
    - service: cover.close_cover
      entity_id: cover.window_shade_5
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_4
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_3
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_2

downstairs_shades_down_all:
  alias: "Downstairs Shades Down All"
  icon: "mdi:grid-large"
  sequence:
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # lower all of the shades
    - service: cover.close_cover
      entity_id: cover.window_shade_5
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_4
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_3
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_2
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_1
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.window_shade_6

downstairs_shades_halfway:
  alias: "Downstairs Shades Halfway"
  icon: "mdi:grid-large"
  sequence:
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # set each of the shades to their midpoint
    - service: cover.set_cover_position
      entity_id: 
        - cover.window_shade_5
        - cover.window_shade_4
        - cover.window_shade_3
        - cover.window_shade_2
      data:
        position: 71

upstairs_shades_down:
  alias: "Upstairs Shades Down"
  icon: "mdi:grid-large"
  sequence:
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # lower the front shades
    - service: cover.close_cover
      entity_id: cover.master_shade_6
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.master_shade_5
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.master_shade_4
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.master_shade_3
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.master_shade_2
    - delay: "00:00:02"
    - service: cover.close_cover
      entity_id: cover.master_shade_1
      
upstairs_shades_up:
  alias: "Upstairs Shades Up"
  icon: "mdi:grid-large"
  sequence:
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # lower the front shades
    - service: cover.open_cover
      entity_id: cover.master_shade_6
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.master_shade_5
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.master_shade_4
    # if the sun is down then don't open
    - condition: template
      value_template: "{{ is_state('sun.sun', 'above_horizon') }}"
    - delay: "00:00:02"
    - service: cover.open_cover
      entity_id: cover.master_shade_3

upstairs_shades_halfway:
  alias: "Upstairs Shades Halfway"
  icon: "mdi:grid-large"
  sequence:
    # disable automatic shades if enabled
    - service: homeassistant.turn_off
      entity_id: group.shade_automation
    # set each of the shades to their midpoint
    - service: cover.set_cover_position
      entity_id: 
        - cover.master_shade_6
        - cover.master_shade_5
        - cover.master_shade_4
      data:
        position: 71